<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:QuanLyXe03.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vlc="clr-namespace:LibVLCSharp.Avalonia;assembly=LibVLCSharp.Avalonia"
        xmlns:local="clr-namespace:QuanLyXe03.Controls"
        mc:Ignorable="d"
        x:Class="QuanLyXe03.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="QuanLyXe"
        Width="1200" Height="800"
        MinWidth="900" MinHeight="600"
        WindowStartupLocation="CenterScreen"
        Background="#f8f9fa">

    <DockPanel>
        
        <!--  Menu Bar -->
        <Menu DockPanel.Dock="Top" Background="#2C3E50" Foreground="White">
            
            <!-- Menu Há»‡ thá»‘ng -->
            <MenuItem Header="Há»‡ thá»‘ng" Foreground="White">
                <MenuItem Header="CÃ i Ä‘áº·t" Click="OpenSettings_Click"/>
                <MenuItem Header="Sao lÆ°u dá»¯ liá»‡u"/>
                <Separator/>
                <MenuItem Header="ThoÃ¡t" Click="Exit_Click"/>
            </MenuItem>
            
            <!-- Menu Dá»¯ liá»‡u -->
            <MenuItem Header="Dá»¯ liá»‡u" Foreground="White">
                <MenuItem Header="Danh sÃ¡ch tháº»" Click="OpenCardManagement_Click"/>
                <MenuItem Header="Lá»‹ch sá»­ xe ra vÃ o" Click="OpenCardEventManagement_Click"/>
                <MenuItem Header="Danh sÃ¡ch khÃ¡ch hÃ ng"/>
            </MenuItem>
            
        </Menu>

        <!-- Grid chÃ­nh -->
        <Grid RowDefinitions="6*,4*" Background="#ECEFF1">

            <!-- HÃ ng trÃªn: Camera VÃ€O & RA -->
            <!-- HÃ ng trÃªn: Camera VÃ€O & RA vá»›i Grid 2x2 -->
<!-- HÃ ng trÃªn: Camera VÃ€O & RA -->
<Grid Grid.Row="0" ColumnDefinitions="1*,1*" Margin="6">
    
    <!-- ========== CAMERA VÃ€O (Cá»™t trÃ¡i) ========== -->
    <Border Grid.Column="0" Background="#F0F0F0" Margin="5" CornerRadius="8"
            BorderBrush="#27AE60" BorderThickness="2">
        <Grid RowDefinitions="Auto,*">
            <!-- Header VÃ€O -->
            <Border Background="#27AE60" Height="32" CornerRadius="8,8,0,0">
                <TextBlock Text="ðŸš— VÃ€O" 
                           Foreground="White" FontSize="16" FontWeight="Bold"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            
            <!-- Layout: Camera chÃ­nh TRÃI + 2 phá»¥ PHáº¢I xáº¿p dá»c -->
            <Grid Grid.Row="1" ColumnDefinitions="2*,1*" Margin="4">
                
                <!-- Camera CHÃNH VÃ€O (cá»™t trÃ¡i, to) -->
                <Border Grid.Column="0" Background="Black" Margin="0,0,2,0" CornerRadius="4">
                    <Grid>
                        <vlc:VideoView x:Name="CameraInView"
                                       IsVisible="{Binding !IsLinux}"/>
                        <Image Source="{Binding FrameIn}"
                               IsVisible="{Binding IsLinux}" 
                               Stretch="UniformToFill"/>
                    </Grid>
                </Border>
                
                <!-- 2 Camera PHá»¤ VÃ€O xáº¿p dá»c (cá»™t pháº£i) -->
                <Grid Grid.Column="1" RowDefinitions="1*,1*">
                    <!-- Camera PHá»¤ VÃ€O 2 -->
                    <Border Grid.Row="0" Background="Black" Margin="2,0,0,2" CornerRadius="4">
                        <Grid>
                            <vlc:VideoView x:Name="CameraInExtra1View"
                                           IsVisible="{Binding !IsLinux}"/>
                            <Image Source="{Binding FrameInExtra1}"
                                   IsVisible="{Binding IsLinux}" 
                                   Stretch="UniformToFill"/>
                        </Grid>
                    </Border>
                    
                    <!-- Camera PHá»¤ VÃ€O 3 -->
                    <Border Grid.Row="1" Background="Black" Margin="2,2,0,0" CornerRadius="4">
                        <Grid>
                            <vlc:VideoView x:Name="CameraInExtra2View"
                                           IsVisible="{Binding !IsLinux}"/>
                            <Image Source="{Binding FrameInExtra2}"
                                   IsVisible="{Binding IsLinux}" 
                                   Stretch="UniformToFill"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>

    <!-- ========== CAMERA RA (Cá»™t pháº£i) ========== -->
    <Border Grid.Column="1" Background="#F0F0F0" Margin="5" CornerRadius="8"
            BorderBrush="#C0392B" BorderThickness="2">
        <Grid RowDefinitions="Auto,*">
            <!-- Header RA -->
            <Border Background="#C0392B" Height="32" CornerRadius="8,8,0,0">
                <TextBlock Text="ðŸš— RA" 
                           Foreground="White" FontSize="16" FontWeight="Bold"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
            </Border>
            
            <!-- Layout: 2 phá»¥ TRÃI xáº¿p dá»c + Camera chÃ­nh PHáº¢I -->
            <Grid Grid.Row="1" ColumnDefinitions="1*,2*" Margin="4">
                
                <!-- 2 Camera PHá»¤ RA xáº¿p dá»c (cá»™t trÃ¡i) -->
                <Grid Grid.Column="0" RowDefinitions="1*,1*">
                    <!-- Camera PHá»¤ RA 2 -->
                    <Border Grid.Row="0" Background="Black" Margin="0,0,2,2" CornerRadius="4">
                        <Grid>
                            <vlc:VideoView x:Name="CameraOutExtra1View"
                                           IsVisible="{Binding !IsLinux}"/>
                            <Image Source="{Binding FrameOutExtra1}"
                                   IsVisible="{Binding IsLinux}" 
                                   Stretch="UniformToFill"/>
                        </Grid>
                    </Border>
                    
                    <!-- Camera PHá»¤ RA 3 -->
                    <Border Grid.Row="1" Background="Black" Margin="0,2,2,0" CornerRadius="4">
                        <Grid>
                            <vlc:VideoView x:Name="CameraOutExtra2View"
                                           IsVisible="{Binding !IsLinux}"/>
                            <Image Source="{Binding FrameOutExtra2}"
                                   IsVisible="{Binding IsLinux}" 
                                   Stretch="UniformToFill"/>
                        </Grid>
                    </Border>
                </Grid>
                
                <!-- Camera CHÃNH RA (cá»™t pháº£i, to) -->
                <Border Grid.Column="1" Background="Black" Margin="2,0,0,0" CornerRadius="4">
                    <Grid>
                        <vlc:VideoView x:Name="CameraOutView"
                                       IsVisible="{Binding !IsLinux}"/>
                        <Image Source="{Binding FrameOut}"
                               IsVisible="{Binding IsLinux}" 
                               Stretch="UniformToFill"/>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Grid>

            <!-- HÃ ng dÆ°á»›i: ThÃ´ng tin + Snapshot + NÃºt má»Ÿ cá»•ng -->
            <Grid Grid.Row="1" ColumnDefinitions="1.3*,3*,1.3*" Margin="8">

                <!-- ThÃ´ng tin xe VÃ€O -->
                <Border Grid.Column="0" Background="White" Margin="5" Padding="10"
                        CornerRadius="8" BorderBrush="#27AE60" BorderThickness="2">
                    <StackPanel>
                        <TextBlock Text="ThÃ´ng tin xe VÃ€O" 
                                   FontSize="14" 
                                   FontWeight="Bold"
                                   Margin="0,0,0,10" 
                                   HorizontalAlignment="Center"
                                   Foreground="#27AE60"/>
                        
                        <TextBlock Text="{Binding PlateNumberIn, StringFormat='ðŸš— Biá»ƒn sá»‘: {0}'}" 
                                   FontSize="14" 
                                FontWeight="Bold"
                                Foreground="Black" 
                                Margin="0,0,0,8"
                                TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{Binding VehicleDateTimeIn, StringFormat='ðŸ• Thá»i gian: {0}'}" 
                                   FontSize="13" 
                                   Foreground="Black" 
                                   Margin="0,0,0,6"
                                   TextWrapping="Wrap"/>
                        



                         <TextBlock Text="{Binding CardGroupIn, StringFormat='ðŸ“‡ NhÃ³m tháº»: {0}'}"
                            FontSize="13" 
                                   Foreground="Black" 
                                   Margin="0,0,0,6"
                                   TextWrapping="Wrap"/>


                        <TextBlock Text="{Binding ExpireDateIn, StringFormat='ðŸ“… Háº¿t háº¡n: {0}'}"
                            FontSize="13" 
                                   Foreground="Black" 
                                   Margin="0,0,0,6"
                                   TextWrapping="Wrap"/>
                        
                        <TextBlock Text="{Binding StatusMessageIn}" 
                                   FontSize="13" 
                                   FontWeight="Bold"
                                   Foreground="#27AE60" 
                                   Margin="0,8,0,0"
                                   TextWrapping="Wrap"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>

                <!-- áº¢nh snapshot + NÃºt chá»©c nÄƒng + NÃºt má»Ÿ cá»•ng -->
                <Border Grid.Column="1" Margin="5" Background="Transparent">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- 3 áº¢nh snapshot -->
                        <Grid Grid.Row="0" ColumnDefinitions="1*,1*,1*" Margin="0">
                            <Border Grid.Column="0" Background="White" BorderBrush="#BDC3C7"
                                    BorderThickness="1" CornerRadius="6" Margin="4" MinHeight="80">
                                <Image Source="{Binding Snapshot1}" Stretch="Uniform"/>
                            </Border>
                            <Border Grid.Column="1" Background="White" BorderBrush="#BDC3C7"
                                    BorderThickness="1" CornerRadius="6" Margin="4" MinHeight="80">
                                <Image Source="{Binding Snapshot2}" Stretch="Uniform"/>
                            </Border>
                            <Border Grid.Column="2" Background="White" BorderBrush="#BDC3C7"
                                    BorderThickness="1" CornerRadius="6" Margin="4" MinHeight="80">
                                <Image Source="{Binding Snapshot3}" Stretch="Uniform"/>
                            </Border>
                        </Grid>

                        <!-- NÃºt chá»©c nÄƒng (chá»¥p, ghi vÃ o/ra, in) -->
                        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Center"
                                    VerticalAlignment="Center" Margin="0,8,0,8" Spacing="12">
                            <Button Content="Chá»¥p láº¡i"
                                    Command="{Binding CaptureSnapshotCommand}"
                                    Background="#7F8C8D" Foreground="White"
                                    MinWidth="100" MinHeight="40" Padding="8,4"
                                    FontSize="12"/>
                            <Button Content="Ghi vÃ o"
                                    Command="{Binding CheckInCommand}"
                                    Background="#27AE60" Foreground="White"
                                    MinWidth="100" MinHeight="40" Padding="8,4"
                                    FontSize="12"/>
                            <Button Content="Ghi ra"
                                    Command="{Binding CheckOutCommand}"
                                    Background="#C0392B" Foreground="White"
                                    MinWidth="100" MinHeight="40" Padding="8,4"
                                    FontSize="12"/>
                            <Button Content="In"
                                    Background="#7F8C8D" Foreground="White"
                                    MinWidth="100" MinHeight="40" Padding="8,4"
                                    FontSize="12"/>
                        </StackPanel>

                        <!-- NÃšT Má»ž Cá»”NG (Space) -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center"
                                    VerticalAlignment="Center" Spacing="15" Margin="0,0,0,10">
                            <Button Content="Má»ž Cá»”NG VÃ€O (Space)"
                                    Command="{Binding ManualOpenInCommand}"
                                    Background="#27ae60" Foreground="White" FontWeight="Bold"
                                    CornerRadius="8" Padding="15,10" MinWidth="160"/>
                            <Button Content="Má»ž Cá»”NG RA (Space)"
                                    Command="{Binding ManualOpenOutCommand}"
                                    Background="#e74c3c" Foreground="White" FontWeight="Bold"
                                    CornerRadius="8" Padding="15,10" MinWidth="160"/>
                        </StackPanel>

                        <!-- Hiá»ƒn thá»‹ láº§n má»Ÿ tay cuá»‘i -->
                        <TextBlock Grid.Row="2" Text="{Binding LastManualOpen}"
                                   FontStyle="Italic" Foreground="#666"
                                   HorizontalAlignment="Center" Margin="0,50,0,0"
                                   FontSize="12"/>
                    </Grid>
                </Border>

                
               <!-- ThÃ´ng tin xe RA -->
         <Border Grid.Column="2" Background="White" Margin="5" Padding="10"
                CornerRadius="8" BorderBrush="#C0392B" BorderThickness="2">
            <StackPanel>
                <TextBlock Text="ThÃ´ng tin xe RA" 
                           FontSize="14" 
                           FontWeight="Bold"
                           Margin="0,0,0,10" 
                           HorizontalAlignment="Center"
                           Foreground="#C0392B"/>
        
        
                <TextBlock Text="{Binding PlateNumberOut, StringFormat='ðŸš— Biá»ƒn sá»‘: {0}'}" 
                           FontSize="14" 
                           FontWeight="Bold"
                           Foreground="Black" 
                           Margin="0,0,0,8"
                           TextWrapping="Wrap"/>

                 <TextBlock Text="{Binding VehicleDateTimeOut, StringFormat='ðŸ• Thá»i gian: {0}'}" 
                           FontSize="13" 
                           Foreground="Black" 
                           Margin="0,0,0,6"
                           TextWrapping="Wrap"/>
        
                <TextBlock Text="{Binding CardGroupOut, StringFormat='ðŸ“‡ NhÃ³m tháº»: {0}'}"
                           FontSize="13" 
                           Foreground="Black" 
                           Margin="0,0,0,6"
                           TextWrapping="Wrap"/>

                <TextBlock Text="{Binding ExpireDateOut, StringFormat='ðŸ“… Háº¿t háº¡n: {0}'}"
                           FontSize="13" 
                           Foreground="Black" 
                           Margin="0,0,0,6"
                           TextWrapping="Wrap"/>
        
                <Separator Height="1" Background="#ddd" Margin="0,8,0,8"/>
        
                <TextBlock Text="{Binding ParkingFeeOut, StringFormat='ðŸ’° PhÃ­ Ä‘á»—: {0}'}" 
                           FontSize="16" 
                           FontWeight="Bold"
                           Foreground="#C0392B" 
                           Margin="0,0,0,6"
                           HorizontalAlignment="Center"/>
        
                <TextBlock Text="{Binding StatusMessageOut}" 
                           FontSize="13" 
                           FontWeight="Bold"
                           Foreground="#C0392B" 
                           Margin="0,4,0,0"
                           TextWrapping="Wrap"
                           HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </DockPanel>
</Window>